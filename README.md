This project is part of a collaborative project by the Alexander Sasse Group of ZMBH and Lauren Saunders Group of COS, which aims to use zebrafish ATAC-seq single-cell data sets to generate a model which can be used to predict ATAC-seq-data during development from zebrafish genome sequences.
My contribution to this project was to assess whether the zebrafish sn-ATAC-seq data set generated by Lin et al. in 2023 was suitable to generate the model. To achieve this, I performed quality control with the signac and seurat packages. I received help and guidance from Lauren Saunders and Alexander Sasse while performing these tasks.
Overall, I found that the sn-ATAC-seq data set is suitable for generating the model. Therefore, I extracted the peak names as a BED-file and saved the pseudo-bulked and normalized sn-ATAC-seq matrix as a CSV file.

All data in this project is derived from this zebrafish sn-ATAC-seq data set: Lin X, Yang X, Chen C, et al. Single-nucleus chromatin landscapes during zebrafish early embryogenesis. Sci Data. 2023;10(1):464. doi:10.1038/s41597-023-02373-y . It was kindly compiled and pre-processed by Lauren Saunders. The folder `data` contains all data sets produced by the code.

Here is a short overview over what all scripts in `docs` do:

* **Step 1**: Exploration and preparation for subsequent steps

  * *"02-06-ATAC-Seq-Analysis-Step-1"​*:

    * exploring the data sets published by Lin et al. in 2023 and reducing `zfish_snATAC_seq_pk_mtrx` and `zfish_mta_data` to perform ATAC-seq-QC on subsidised data sets before applying it globally.

* **Step 2**: Establishing a workflow for ATAC-seq-QC on the data subsetted in  *"02-06-ATAC-Seq-Analysis-Step-1"​*

  * **Part A:​** *"02-06-ATAC-Seq-Analysis-Step-2.1 seurat norm"​*:

    * Which Seurat normalisation method should be used for ATAC-seq-QC?

    * Conclusion: If seurat based "LogNormalize" but this option is insufficient, therefore manual normalization was performed in  *"02-10-ATAC-Seq-Analysis-Step-2.2 log 1+x norm"​* .

  * **Part B:​** *"02-10-ATAC-Seq-Analysis-Step-2.2 log 1+x norm"​*:

    * normalising manually with natural logarithmic transformation

* **Step 3**: Performing ATAC-seq QC on the entire data set published by Lin et al. in 2023

  * *"02-11-ATAC-Seq-Analysis-Step-3.1.1-log 1+x on all celltypes"​*:

    * pseudo-bulking and manual log-normalization of all data points in the matrix

  * *"02-11-ATAC-Seq-Analysis-Step-3.1.2-seurat on all celltypes"​*:

    * pseudo-bulking and seurat-provided log-normalization of all data points in the matrix

  * *"02-11-ATAC-Seq-Analysis-Step-3.2.1-log 1+x on all celltypes"​*:

    * visualization of ATAC-seq QC after pseudo-bulking and manual log-normalization of all data points in the matrix

  * *"02-11-ATAC-Seq-Analysis-Step-3.2.2-seurat on all celltypes"​*:

    * visualization of ATAC-seq QC after pseudo-bulking and seurat-provided log-normalization of all data points in the matrix

* **Step 4**: Preparation of the sn-ATAC-seq-data set for modelling by Alexander Sasse's group

  * *"03-06-ATAC-Seq-Analysis-Step-4.1-subset-celltypes"​*:

    * subsetting cells 10 hpf and older, as well as removing undesired cell types. Extracting peak names as a BED file (`peaks.zfish_snATAC.10hpf.bed`).

  * *"03-06-ATAC-Seq-Analysis-Step-4.2-psdeudobulk+log 1+x norm subsetted-celltypes"​*:

    * pseudo-bulking and normalization analogous to *"02-11-ATAC-Seq-Analysis-Step-3.1.1-log 1+x on all celltypes"​*, saving of output as csv (`psd.bulk.zfish_atac.10hpf.lg1x.csv`)
